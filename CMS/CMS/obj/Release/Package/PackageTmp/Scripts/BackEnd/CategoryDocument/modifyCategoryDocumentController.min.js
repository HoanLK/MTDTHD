admin.controller("modifyCategoryDocumentController",["$scope","$http","$window","$location","$filter","Alias","Url",function(n,t,r,u,f,e,o){function s(){n.categoryDocument.id!==null?c(n.categoryDocument.id):h()}function h(){n.categoryDocument={published:!0,robots:"Index, Follow",colorBackgroundBanner:"#000000",colorTitleBanner:"#ffffff",colorTextBanner:"#ffffff",timePublished:new Date}}function c(){t.get(apiCategoryDocument+"/"+n.categoryDocument.id).then(function(t){t.status==200?(n.categoryDocument=angular.copy(t.data),n.categoryDocument.timePublished=new Date(n.categoryDocument.timePublished)):r.location.href="/admin/categorypost"},function(){r.location.href="/admin/categorypost"})}function l(t,r){if(t.idParentCategory==null||t.idParentCategory=="")n.categoryDocuments.push(t);else if(n.categoryDocuments.indexOf(t)==-1){for(r++,i=1;i<=r;i++)t.title="– "+t.title;n.categoryDocuments.push(t);angular.forEach(n.tempCategoryDocuments,function(n){n.idParentCategory==t.id&&l(n,r)})}}apiCategoryDocument="/API/CategoryDocumentAPI";n.categoryDocuments=[];n.tempCategoryDocuments=[];n.categoryDocument={};n.statuses=[{text:"Xuất bản",value:!0},{text:"Không xuất bản",value:!1}];n.categoryDocument.id=o.getParameterByName("idCategoryDocument");s();n.Save=function(){n.categoryDocument.id==null?t.post(apiCategoryDocument,n.categoryDocument).then(function(t){t.status==201?(n.categoryDocument=angular.copy(t.data),toastr.success("Thành công","Thêm Danh mục Tài liệu"),r.location.href="/Admin/CategoryDocument/Modify?idCategoryDocument="+n.categoryDocument.id):toastr.error("Thất bại","Thêm Danh mục Tài liệu")},function(){toastr.error("Thất bại","Thêm Danh mục Tài liệu")}):t.put(apiCategoryDocument+"/"+n.categoryDocument.id,n.categoryDocument).then(function(n){n.status==204?toastr.success("Thành công","Lưu Danh mục Tài liệu"):toastr.error("Thất bại","Lưu Danh mục Tài liệu")},function(){toastr.error("Thất bại","Lưu Danh mục Tài liệu")})};n.SaveAndExit=function(){n.categoryDocument.id==null?t.post(apiCategoryDocument,n.categoryDocument).then(function(t){t.status==201?(n.categoryDocument=angular.copy(t.data),toastr.success("Thành công","Thêm Danh mục Tài liệu"),r.location.href="/Admin/CategoryDocument"):toastr.error("Thất bại","Thêm Danh mục Tài liệu")},function(){toastr.error("Thất bại","Thêm Danh mục Tài liệu")}):t.put(apiCategoryDocument+"/"+n.categoryDocument.id,n.categoryDocument).then(function(n){n.status==204?(toastr.success("Thành công","Lưu Danh mục Tài liệu"),r.location.href="/Admin/CategoryDocument"):toastr.error("Thất bại","Lưu Danh mục Tài liệu")},function(){toastr.error("Thất bại","Lưu Danh mục Tài liệu")})};n.SaveAndAdd=function(){n.categoryDocument.id==null?t.post(apiCategoryDocument,n.categoryDocument).then(function(t){t.status==201?(n.categoryDocument=angular.copy(t.data),toastr.success("Thành công","Thêm Danh mục Tài liệu"),r.location.href="/Admin/CategoryDocument/Modify"):toastr.error("Thất bại","Thêm Danh mục Tài liệu")},function(){toastr.error("Thất bại","Thêm Danh mục Tài liệu")}):t.put(apiCategoryDocument+"/"+n.categoryDocument.id,n.categoryDocument).then(function(n){n.status==204?(toastr.success("Thành công","Lưu Danh mục Tài liệu"),r.location.href="/Admin/CategoryDocument/Modify"):toastr.error("Thất bại","Lưu Danh mục Tài liệu")},function(){toastr.error("Thất bại","Lưu Danh mục Tài liệu")})};n.Cancel=function(){r.location.href="/Admin/CategoryDocument"};n.ChooseImage=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.categoryDocument.image=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.ChooseImageBanner=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.categoryDocument.imageBanner=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.GenAlias=function(){n.categoryDocument.alias=angular.copy(e.genAlias(n.categoryDocument.title))}}]);