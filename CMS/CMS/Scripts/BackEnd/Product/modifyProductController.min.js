admin.controller("modifyProductController",["$scope","$http","$window","$location","$filter","Alias","Url","$sce",function(n,t,r,u,f,e,o){function h(){c();n.product.id!==null?a(n.product.id):l()}function c(){t.get("/CategoryProduct/GetAll").then(function(t){t.status==200&&(n.tempCategoryProducts=angular.copy(t.data),angular.forEach(n.tempCategoryProducts,function(n){s(n,0)}))},function(){})}function l(){n.product={featured:!1,published:!0,version:1,robots:"Index, Follow",colorBackgroundBanner:"#000000",colorTitleBanner:"#ffffff",colorTextBanner:"#ffffff",timePublished:new Date}}function a(){t.get(apiProduct+"/"+n.product.id).then(function(t){t.status==200?(n.product=angular.copy(t.data),n.product.timePublished=new Date(n.product.timePublished)):r.location.href="/Admin/Product"},function(){r.location.href="/Admin/Product"})}function s(t,r){if(n.categoryProducts.indexOf(t)==-1){for(i=1;i<=r;i++)t.title="– "+t.title;r++;n.categoryProducts.push(t);angular.forEach(n.tempCategoryProducts,function(n){n.idParentCategory==t.id&&s(n,r)})}}apiProduct="/API/ProductAPI";n.product={};n.categoryProducts=[];n.tempCategoryProducts=[];n.statuses=[{text:"Xuất bản",value:!0},{text:"Không xuất bản",value:!1}];n.featureds=[{text:"Có",value:!0},{text:"Không",value:!1}];n.categoryProducts=[];n.product.id=o.getParameterByName("idProduct");h();n.Save=function(){n.product.id==null?t.post(apiProduct,n.product).then(function(t){t.status==201?(n.product=angular.copy(t.data),toastr.success("Thành công","Thêm Bài viết"),r.location.href="/Admin/Product/Modify?idProduct="+n.product.id):toastr.error("Thất bại","Thêm Bài viết")},function(){toastr.error("Thất bại","Thêm Bài viết")}):t.put(apiProduct+"/"+n.product.id,n.product).then(function(n){n.status==204?toastr.success("Thành công","Lưu Bài viết"):toastr.error("Thất bại","Lưu Bài viết")},function(){toastr.error("Thất bại","Lưu Bài viết")})};n.SaveAndExit=function(){n.product.id==null?t.post(apiProduct,n.product).then(function(t){t.status==201?(n.product=angular.copy(t.data),toastr.success("Thành công","Thêm Bài viết"),r.location.href="/Admin/Product"):toastr.error("Thất bại","Thêm Bài viết")},function(){toastr.error("Thất bại","Thêm Bài viết")}):t.put(apiProduct+"/"+n.product.id,n.product).then(function(n){n.status==204?(toastr.success("Thành công","Lưu Bài viết"),r.location.href="/Admin/Product"):toastr.error("Thất bại","Lưu Bài viết")},function(){toastr.error("Thất bại","Lưu Bài viết")})};n.SaveAndAdd=function(){n.product.id==null?t.post(apiProduct,n.product).then(function(t){t.status==201?(n.product=angular.copy(t.data),toastr.success("Thành công","Thêm Bài viết"),r.location.href="/Admin/Product/Modify"):toastr.error("Thất bại","Thêm Bài viết")},function(){toastr.error("Thất bại","Thêm Bài viết")}):t.put(apiProduct+"/"+n.product.id,n.product).then(function(n){n.status==204?(toastr.success("Thành công","Lưu Bài viết"),r.location.href="/Admin/Product/Modify"):toastr.error("Thất bại","Lưu Bài viết")},function(){toastr.error("Thất bại","Lưu Bài viết")})};n.Cancel=function(){r.location.href="/Admin/Product"};n.ChooseImage=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.product.image=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.ChooseImage1=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.product.hinhanh1=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.ChooseImage2=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.product.hinhanh2=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.ChooseImage3=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.product.hinhanh3=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.ChooseImage4=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.product.hinhanh4=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.ChooseImage5=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.product.hinhanh5=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.ChooseImage6=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.product.hinhanh6=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.ChooseImageBanner=function(){var t=new CKFinder;t.selectActionFunction=function(t){n.product.imageBanner=t;n.$apply()};t.SelectFunction="ShowFileInfo";t.popup()};n.GenAlias=function(){n.product.alias=angular.copy(e.genAlias(n.product.title))}}]);